<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Board</title>
  </head>
  <script>
var icons = "🟠🟡🟢🟣🟤🟥🟦🟧🟨🟩🟪🟫🐁🐂🐆🐇🐲🐍🐎🐏🐒🐓🐕🐖👦👧👨👩👱👲👳👴👵👶♈♉♊♋♌♍♎♏♐♑♒♓";
var currentYear = 80; // 年龄，按季度计算

var diceTils = [["0","1","2","3","4","5","6"],
                [" ","壹","贰","叁","肆","伍","陆"],
                [" ","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ"],
                [" ","〡","〢","〣","〤","〥","〦"],
                [" ","⚀","⚁","⚂","⚃","⚄","⚅"],
                [" ","🀙","🀚","🀛","🀜","🀝","🀞"],
                [" ","🂡","🂢","🂣","🂤","🂥","🂦"],
                [" ","庄","由","良","德","功","才"]];
var diceName = "德才功良由庄";
var dice = [1,1,1,1,1,1];
var dicevalue = "";
var diceCount = [[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];
var diceType = 0;

var diceFamily = [["64",    "衍聖公",    "",  ""],
                  ["66",    "朝鮮王",    "",  ""],
                  ["65",    "安南王",    "",  ""],
                  ["63",    "琉球王",    "",  ""],
                  ["62",    "海澄公",    "",  ""],
                  ["61",    "近恩侯",    "",  ""],
                  ["54",    "和碩額驸",  "",  ""],
                  ["56",    "多羅額驸",  "",  ""],
                  ["55",    "縣主額驸",  "",  ""],
                  ["53",    "郡君額驸",  "",  ""],
                  ["52",    "縣君額驸",  "",  ""],
                  ["51",    "鄉君額驸",  "",  ""],
                  ["442",   "聖裔奉祀生","",  ""],
                  ["412",   "賢裔奉祀生","",  ""],
                  ["422",   "賢裔奉祀生","",  ""],
                  ["432",   "賢裔奉祀生","",  ""],
                  ["452",   "賢裔奉祀生","",  ""],
                  ["462",   "賢裔奉祀生","",  ""],
                  ["44",    "台吉",      "20","蒙"],
                  ["46",    "内侍衛",    "30",""],
                  ["45",    "内侍衛",    "25",""],
                  ["43",    "内侍衛",    "15",""],
                  ["44",    "恩賞",      "",  ""],
                  ["46",    "保舉",      "",  ""],
                  ["45",    "詞科",      "",  ""],
                  ["43",    "軍功",      "",  ""],
                  ["42",    "議敘",      "",  ""],
                  ["41",    "鄉勇",      "",  ""],
                  ["3431",  "黃帶子",    "",  ""],
                  ["343",   "紅帶子",    "",  ""],
                  ["313",   "紅帶子",    "",  ""],
                  ["323",   "紅帶子",    "",  ""],
                  ["333",   "紅帶子",    "",  ""],
                  ["353",   "紅帶子",    "",  ""],
                  ["34",    "筆貼式",    "",  "滿"],
                  ["36",    "繙譯生",    "",  ""],
                  ["35",    "官學生",    "",  "滿"],
                  ["33",    "樂舞生",    "",  ""],
                  ["32",    "供士",      "",  ""],
                  ["31",    "守兵",      "",  ""],
                  ["232221","旗丁",      "",  ""],
                  ["262524","鴻博",      "",  ""],
                  ["24212", "額外中書",  "",  ""],
                  ["24232", "額外旗員",  "",  ""],
                  ["24222", "額外旗員",  "",  ""],
                  ["23222", "額外旗員",  "",  ""],
                  ["23212", "額外旗員",  "",  ""],
                  ["22212", "額外旗員",  "",  ""],
                  ["2421",  "庫史",      "",  ""],
                  ["262",   "職員",      "",  ""],
                  ["252",   "職員",      "",  ""],
                  ["242",   "職員",      "",  ""],
                  ["232",   "職員",      "",  ""],
                  ["222",   "職員",      "",  ""],
                  ["212",   "職員",      "",  ""],
                  ["24",    "生員",      "",  ""],
                  ["26",    "武生",      "",  ""],
                  ["25",    "監生",      "",  ""],
                  ["23",    "驍騎",      "",  ""],
                  ["22",    "吏員",      "",  ""],
                  ["21",    "童生",      "",  ""],
                  ["",      "蔭生",      "",  ""]];

var diceRun = [["44 21", "德德德德","0"],
               ["34 31", "德德德","0"],
               ["24 41", "德德","0"],
               ["24", "德","1"],
               ["34", "德德","1"],
               ["44", "德德德","1"],
               ["54", "德德德德才","1"],
               ["64", "德德德德德德德","1"],
               ["26", "才","1"],
               ["36", "才","1"],
               ["46", "才","1"],
               ["56", "德德德才","1"],
               ["66", "德德德德德德才","1"],
               ["25", "功","1"],
               ["35", "功","1"],
               ["45", "功","1"],
               ["55", "德德德功","1"],
               ["65", "德德德德德德功","1"],
               ["23", "良","1"],
               ["33", "良","1"],
               ["43", "良","1"],
               ["53", "德德德","1"],
               ["63", "德德德德德德","1"],
               ["22", "由","1"],
               ["32", "由","1"],
               ["42", "由","1"],
               ["52", "德德才","1"],
               ["62", "德德德德德才","1"],
               ["21", "庄","1"],
               ["31", "庄","1"],
               ["41", "庄","1"],
               ["51", "德德功","1"],
               ["61", "德德德德德功","1"]];

//  出身=FM=黑，满=MC=紫，文=CV=紅，武=MO=青，钦天太医土司=ET=绿，蒙=MG=暗黄，处分=RP=蓝
//                  號    名稱           SYS   ACT    SYSTEM、
var department = [["D001","出身",        "FM", "",""],
                  ["D002","降官",        "RP", "不同二德","漢文"],
                  ["D003","起服",        "RP", "不同二德","漢文"],
                  ["D004","致士",        "RP", "不同二德","漢文"],
                  ["D005","处分",        "RP", "","漢文"],
                  ["D006","武職处分",    "RP", "","漢文"],
                  ["D007","入公筹",      "RP", "以上具入公筹",""],
                  ["D008","河标",        "MO", "不同二德",""],
                  ["D009","漕标",        "MO", "不同二德",""],
                  ["D010","旗院",        "MO", "",""],
                  ["D010","提标",        "MO", "",""],
                  ["D012","鎮标",        "MO", "",""],
                  ["D013","协标",        "MO", "",""],
                  ["D014","守营",        "MO", "",""],
                  ["D015","粮衛",        "MO", "",""],
                  ["D016","聖庙",        "MO", "",""],
                  ["D017","林庙",        "MO", "",""],
                  ["D018","巡防",        "MO", "",""],
                  ["D019","軍政",        "MO", "",""],
                  ["D020","土府",        "ET", "",""],
                  ["D021","土州",        "ET", "",""],
                  ["D022","土縣",        "ET", "",""],
                  ["D023","武衛",        "ET", "",""],
                  ["D024","台吉府",      "MG", "不同二德","蒙"],
                  ["D025","漢侍衛府",    "MO", "不同二德","漢武"],
                  ["D026","文殿試",      "CV", "","漢文"],
                  ["D027","武殿試",      "MO", "","漢武"],
                  ["D028","文會試",      "CV", "","漢文"],
                  ["D029","武會試",      "MO", "","漢武"],
                  ["D030","文鄉試",      "CV", "","漢文"],
                  ["D031","武鄉試",      "MO", "","漢武"],
                  ["D032","學院",        "CV", "不同二德","漢文"],
                  ["D033","會辦軍务",    "CV", "不同二德","蒙"],
                  ["D034","旷典",        "CV", "不同二德","蒙"],
                  ["D035","各管",        "CV", "不同二德","蒙"],
                  ["D036","軍功",        "CV", "不同二德","蒙"],
                  ["D037","河功",        "MO", "不同二德","蒙"],
                  ["D038","文京察",      "CV", "不同二德","蒙"],
                  ["D039","武京察",      "MO", "不同二德","蒙"],
                  ["D040","大計",        "CV", "不同二德","蒙"],
                  ["D041","功牌",        "MO", "不同二德","蒙"],
                  ["D042","大考",        "CV", "",""],
                  ["D043","陵寝",        "MO", "不同二德",""],
                  ["D044","太僕寺马厂",  "MO", "不同二德",""],
                  ["D045","各城駐防",    "MO", "不同二德",""],
                  ["D046","外省駐防",    "MO", "不同二德",""],
                  ["D047","京畿巡捕五营","MO", "不同二德",""],
                  ["D048","督院",        "MO", "不同二德",""],
                  ["D049","抚院",        "MO", "",""],
                  ["D050","京府",        "CV", "",""],
                  ["D051","外府",        "CV", "",""],
                  ["D052","直隷州",      "CV", "",""],
                  ["D053","外州",        "CV", "",""],
                  ["D054","直隷廰",      "CV", "",""],
                  ["D055","京縣",        "CV", "",""],
                  ["D056","外縣",        "CV", "",""],
                  ["D057","兼銜",        "CV", "",""],
                  ["D058","钦差軍务",    "CV", "",""],
                  ["D059","至聖裔官",    "CV", "",""],
                  ["D060","丹使",        "MO", "",""],
                  ["D061","满侍衛府",    "MO", "",""],
                  ["D062","满八旗",      "MO", "",""],
                  ["D063","蒙八旗",      "MO", "",""],
                  ["D064","漢八旗",      "MO", "",""],
                  ["D065","前锋",        "MO", "不同二德",""],
                  ["D066","护軍",        "MO", "不同二德",""],
                  ["D067","步軍",        "MO", "不同二德",""],
                  ["D068","圆明园",      "MO", "不同二德",""],
                  ["D069","火器营",      "MO", "不同二德",""],
                  ["D070","健锐营",      "MO", "不同二德",""],
                  ["D071","白塔信炮",    "MO", "不同二德",""],
                  ["D072","南苑",        "MO", "不同二德",""],
                  ["D073","内府包衣",    "MO", "不同二德",""],
                  ["D074","王府",        "MO", "不同二德","漢武"],
                  ["D075","河院",        "CV", "不同二德",""],
                  ["D076","鹽院",        "CV", "不同二德",""],
                  ["D077","布政使司",    "CV", "不同二德",""],
                  ["D078","按察使司",    "CV", "不同二德",""],
                  ["D079","各道",        "CV", "不同二德",""],
                  ["D080","各差",        "CV", "不同二德",""],
                  ["D081","六科",        "CV", "",""],
                  ["D082","神樂署",      "CV", "",""],
                  ["D083","武備院",      "CV", "",""],
                  ["D084","上駟院",      "CV", "",""],
                  ["D085","奉宸院",      "CV", "",""],
                  ["D086","通政司",      "CV", "",""],
                  ["D087","皇史窚",      "CV", "",""],
                  ["D088","中書科",      "CV", "",""],
                  ["D089","大理寺",      "CV", "",""],
                  ["D090","太常寺",      "CV", "",""],
                  ["D091","太僕寺",      "CV", "",""],
                  ["D092","光禄寺",      "CV", "",""],
                  ["D093","鴻臚寺",      "CV", "",""],
                  ["D094","各部院",      "CV", "",""],
                  ["D095","太醫院",      "ET", "",""],
                  ["D096","王府",        "CV", "不同二德","漢文"],
                  ["D097","欽天監",      "ET", "不同二德",""],
                  ["D098","鑾儀門",      "MO", "不同二德",""],
                  ["D099","崇文門",      "CV", "不同二德",""],
                  ["D100","仓场",        "CV", "不同二德",""],
                  ["D101","兵马司",      "CV", "不同二德",""],
                  ["D102","督院",        "CV", "不同二德",""],
                  ["D103","漕院",        "CV", "不同二德",""],
                  ["D104","抚院",        "CV", "不同二德",""],
                  ["D105","理藩院",      "CV", "不同二德",""],
                  ["D106","都察院",      "CV", "不同二德",""],
                  ["D107","会同四驿馆",  "CV", "不同二德",""],
                  ["D108","内务府",      "CV", "不同軍功",""],
                  ["D109","内閣",        "CV", "不同二德",""],
                  ["D110","宗人府",      "CV", "不同二德",""],
                  ["D111","吏部",        "CV", "不同二德",""],
                  ["D112","户部",        "CV", "不同二德",""],
                  ["D113","禮部",        "CV", "不同二德",""],
                  ["D114","兵部",        "CV", "不同二德",""],
                  ["D115","刑部",        "CV", "不同二德",""],
                  ["D116","工部",        "CV", "不同二德",""],
                  ["D117","國子監",      "CV", "不同二德",""],
                  ["D118","翰林院",      "CV", "不同二德",""],
                  ["D119","詹事府",      "CV", "不同二德",""],
                  ["D120","恩袭",        "CV", "不同二德",""],
                  ["D121","封典",        "CV", "",""],
                  ["D122","功臣世爵",    "CV", "",""],
                  ["D123","出身世爵",    "CV", "",""],
                  ["D124","公主額驸",    "CV", "",""],
                  ["D125","经略大臣",    "CV", "",""],
                  ["D126","宫衛",        "CV", "",""],
                  ["D127","特恩",        "CV", "",""],
                  ["D128","殿閣大學士",  "CV", "",""],
                  ["D129","品级考",      "CV", "",""],
                  ["D130","内廷",        "CV", "",""],
//                  ["D131","出身对照表",  "",""],
//                  ["D132","颜色对照表",  "",""],
//                  ["D133","捐班",        "FM",""]
                  ];

//                號  子    品級   名稱   德       才     功       良     由    庄
var position = [['D001P01','',    '台吉',      "三等台吉","D024P03","四等台吉","D024P04","四等台吉","D024P04","",        "D001P01","",        "D001P01","",        "D001P01"],
                ['D001P02','',    '内侍衛',    "三等侍衛","D061P03","四等侍衛","D061P04","蓝翎",    "DxxxPxx","",        "D001P02","",        "D001P02","",        "D001P02"],
                ['D001P03','',    '聖裔奉祀生',"五经博士","DxxxPxx","八品执事","DxxxPxx","九品执事","DxxxPxx","",        "D001P03","",        "D001P03","",        "D001P03"],
                ['D001P04','',    '賢裔奉祀生',"五经博士","DxxxPxx","八品执事","DxxxPxx","學录",    "DxxxPxx","翰簿",    "DxxxPxx","",        "D001P03","",        "D001P03"],
                ['D001P05','',    '黃帶子'],
                ['D001P06','',    '紅帶子'],
                ['D001P07','',    '額外中書'],
                ['D001P08','',    '額外旗員'],
                ['D001P09','',    '庫史'],
                ['D001P10','',    '職員'],
                ['D001P11','',    '鴻博'],
                ['D001P12','',    '蔭生'],
                ['D001P13','',    '恩賞'],
                ['D001P14','',    '保舉'],
                ['D001P15','',    '詞科'],
                ['D001P16','',    '軍功'],
                ['D001P17','',    '議敘'],
                ['D001P18','',    '鄉勇'],
                ['D001P19','',    '筆貼式'],
                ['D001P20','',    '繙譯生'],
                ['D001P21','',    '官學生'],
                ['D001P22','',    '樂舞生'],
                ['D001P23','',    '供士'],
                ['D001P24','',    '守兵'],
                ['D001P25','',    '生員'],
                ['D001P26','',    '武生'],
                ['D001P27','',    '監生'],
                ['D001P28','',    '驍騎'],
                ['D001P29','',    '吏員'],
                ['D001P30','',    '童生'],
                ['D001P31','',    '旗丁'],
                ['D001P32','',    '天文生'],
                ['D001P33','',    '醫生'],
                ['D001P34','',    '土司'],

                ["D024P01","一等","一等台吉","恩袭·輔國公","D120P6","滿八旗·都統","D062P01","漢八旗·都統","D064P01","外省駐防·都統","D046P01","留","D024P01","二等台吉","D024P02"],
                ["D024P02","二等","二等台吉","恩袭·鎮國公","D120P5","一位","D024P01","藩右","","紀錄","","留","D024P02","下一","D024P03"],
                ["D024P03","三等","三等台吉","二等台吉","D024P02","漢八旗·副都統","","外副都","","入鎮國","","留","D024P03","下一","D024P04"],
                ["D024P04","四等","四等台吉","三等台吉","D024P03","蒙參",    "D063P03","漢參",    "DxxxPxx","入輔國",  "DxxxPxx","留",      "D024P04","免",      "DxxxPxx"],


                ['D031P01','','主考'],
                ['D031P02','','監射'],
                ['D031P03','','同考'],
                ['D031P04','','解元'],
                ['D031P05','','经魁'],
                ['D031P06','','舉人'],
                ['D032P01','','學政'],
                ['D032P02','','巡捕'],
                ['D032P03','','教授'],
                ['D032P04','','學正'],
                ['D032P05','','教谕'],
                ['D032P06','','训导'],
                ['D032P07','','拔贡'],
                ['D032P08','','优贡'],
                ['D032P09','','恩贡'],
                ['D032P10','','岁贡'],
                ['D032P11','','禀生'],
                ['D032P12','','增生'],
                ['D032P13','','佾生'],
                ['D033P01','','大将軍'],
                ['D033P02','','帮办大臣'],
                ['D033P03','','翼长'],
                ['D033P04','','领队'],
                ['D033P05','','粮臺'],
                ['D033P06','','支应局'],
                ['D033P07','','文案'],
                ['D033P08','','軍装'],
                ['D033P09','','随大营'],
                ['D033P10','','押饷'],
                ['D033P11','','绘图'],
                ['D034P01','','鴻博'],
                ['D034P02','','賢良方正'],
                ['D034P03','','考廉方正'],
                ['D034P04','','舉人召试'],
                ['D034P05','','員監召试'],
                ['D035P01','','舉人謄録'],
                ['D035P02','','員監謄録'],
                ['D036P01','','一品'],
                ['D036P02','','二品'],
                ['D036P03','','三品'],
                ['D036P04','','四品'],
                ['D036P05','','五品'],
                ['D036P06','','六品'],
                ['D036P07','','七品'],
                ['D036P08','','八品'],
                ['D036P09','','九品'],
                ['D037P01','','一品'],
                ['D037P02','','二品'],
                ['D037P03','','三品'],
                ['D037P04','','四品'],
                ['D037P05','','五品'],
                ['D037P06','','六品'],
                ['D037P07','','七品'],
                ['D037P08','','八品'],
                ['D037P09','','九品'],
                ['D038P01','','一品'],
                ['D038P02','','二品'],
                ['D038P03','','三品'],
                ['D038P04','','四品'],
                ['D038P05','','五品'],
                ['D038P06','','编检'],
                ['D038P07','','六品'],
                ['D038P08','','七品'],
                ['D038P09','','八品'],
                ['D038P10','','九品'],
                ['D039P01','','一品'],
                ['D039P02','','二品'],
                ['D039P03','','三品'],
                ['D039P04','','四品'],
                ['D039P05','','五品'],
                ['D039P06','','參佐'],
                ['D039P07','','六品'],
                ['D039P08','','七品'],
                ['D039P09','','八品'],
                ['D039P10','','九品'],
                ['D040P01','','大计'],
                ['D040P02','','卓异'],
                ['D040P03','','内记名'],
                ['D040P04','','保升'],
                ['D040P05','','加衔'],
                ['D040P06','','議敘'],
                ['D040P07','','加级'],
                ['D040P08','','纪录'],
                ['D041P01','','一等'],
                ['D041P02','','二等'],
                ['D041P03','','三等'],
                ['D041P04','','四等'],
                ['D042P01','','一品'],
                ['D042P02','','二品'],
                ['D042P03','','三品'],
                ['D042P04','','四品'],
                ['D042P05','','五品'],
                ['D042P06','','六品'],
                ['D042P07','','编检'],
                ["D043P01","正三","總管","外副都","","提副","","外總管","","紀錄","","留","","僕總",""],
                ["D043P02","正六","翼长","總管","","包參","","城守尉","","紀錄","","留","","防御",""],
                ["D043P03","正五","防御","翼长","","城门领","","外副參","","紀錄","","留","","驍騎校",""],
                ["D043P04","正六","驍騎校","外驍騎","","僕翼","","督千","","紀錄","","留","","游牧正",""],
                ['D044P01','正四','總管'],
                ['D044P02','正六','翼长'],
                ['D044P03','正四','固守尉'],
                ['D044P04','正七','城门吏'],
                ['D045P01','從三','固守尉'],
                ['D045P02','正四','城门吏'],
                ['D045P03','從四','固守尉'],
                ['D045P04','從三','协领'],
                ['D046P01','從一','都统'],
                ['D046P02','從二','副都统'],
                ['D046P03','正三','總管'],
                ['D046P04','從三','协领'],
                ['D046P05','從三','參领'],
                ['D046P06','正四','佐领'],
                ['D046P07','從四','副參领'],
                ['D046P08','從四','副佐领'],
                ['D046P09','正五','防御'],
                ['D046P10','從五','驍騎校'],
                ['D046P11','從六','补盗官'],
                ['D046P12','正七','游牧正尉'],
                ['D046P13','從七','副尉'],
                ['D046P14','正八','游牧翼长'],
                ['D046P15','正九','蓝领长'],
                ['D047P01','從一','翼總兵'],
                ['D047P02','正二','九门提督'],
                ['D047P03','從二','副将'],
                ['D047P04','正三','參将'],
                ['D047P05','從三','游击'],
                ['D047P06','正四','都司'],
                ['D047P07','正五','守备'],
                ['D047P08','正六','守御千總'],
                ['D047P09','正六','把總'],
                ['D048P01','',    '大總戎'],
                ['D048P02','從二','副将'],
                ['D048P03','正三','參将'],
                ['D048P04','從三','游击'],
                ['D048P05','正四','都司'],
                ['D048P06','正五','守备'],
                ['D048P07','正六','千總'],
                ['D048P08','正七','把總'],
                ['D048P09','',    '提塘'],
                ['D049P01','正二','巡抚'],
                ['D049P02','正三','參将'],
                ['D049P03','從三','游击'],
                ['D049P04','正四','都司'],
                ['D049P05','正五','守备'],
                ['D049P06','正六','千總'],
                ['D049P07','正七','把總'],
                ['D049P08','',    '提塘'],
                ['D049P09','ACT', '封'],

                ['D065P01','正二','统领'],
                ['D065P02','正三','參领'],
                ['D065P03','正四','副參领'],
                ['D065P04','正四','委署參领'],
                ['D065P05','正四','前锋侍衛'],
                ['D065P06','正五','委署前锋'],
                ['D065P07','從六','前锋校'],
                ['D065P08','從八','委署前锋校'],
                ['D066P01','正二','统领'],
                ['D066P02','正三','參领'],
                ['D066P03','正四','副參领'],
                ['D066P04','正五','委署參领'],
                ['D066P05','從六','各軍校'],
                ['D066P06','從八','委署軍校'],
                ['D067P01','正二','统领'],
                ['D067P02','正三','參领'],
                ['D067P03','正四','协领'],
                ['D067P04','從四','副领'],
                ['D067P05','正五','步軍校'],
                ['D067P06','從六','委署步軍校'],
                ['D068P01','正三','參领'],
                ['D068P02','正四','副參领'],
                ['D068P03','正五','參领'],
                ['D068P04','','總统'],
                ['D069P01','正三','翼领'],
                ['D069P02','正四','副领'],
                ['D069P03','','總统'],
                ['D070P01','正三','翼领'],
                ['D070P02','正四','副领'],
                ['D070P03','','總统'],
                ['D071P01','正四','總尉'],
                ['D071P02','從四','炮官'],
                ['D072P01','正四','總尉'],
                ['D072P02','正五','京章'],
                ['D072P03','正六','六品委署京章'],
                ['D072P04','正七','七品委署京章'],
                ['D073P01','正三','统领'],
                ['D073P02','正三','參领'],
                ['D073P03','從四','副參领'],
                ['D074P01','正三','长史'],
                ['D074P02','從三','一等护衛'],
                ['D074P03','從四','二等护衛'],
                ['D074P04','從五','三等护衛'],
                ['D074P05','正四','司仪长'],
                ['D074P06','正四','典議'],
                ['D074P07','正五','典議'],
                ['D074P08','正六','典議'],
                ['D074P09','正七','典議'],
                ['D074P10','正八','典議'],
                ['D074P11','','散騎郎'],
                ['D075P01','從一','河督'],
                ['D075P02','正四','河道'],
                ['D075P03','正五','同知'],
                ['D075P04','正六','通判'],
                ['D075P05','從六','州同'],
                ['D075P06','從七','州判'],
                ['D075P07','正八','縣丞'],
                ['D075P08','正九','主簿'],
                ['D075P09','從九','巡检'],
                ['D075P10','未入','闸官'],
                ['D076P01','從三','运使'],
                ['D076P02','正四','盐道'],
                ['D076P03','從四','运同'],
                ['D076P04','正五','提舉'],
                ['D076P05','從五','运副'],
                ['D076P06','正六','監掣'],
                ['D076P07','從六','运判'],
                ['D076P08','從七','经历'],
                ['D076P09','正八','大使'],
                ['D076P10','從八','知事'],
                ['D076P11','從九','巡检'],
                ['D076P12','ACT','盐政'],
                ['D077P01','從二','布政使'],
                ['D077P02','從六','经历'],
                ['D077P03','從六','理问'],
                ['D077P04','從七','都事'],
                ['D077P05','正八','庫大使'],
                ['D077P06','從八','照磨'],
                ['D078P01','正三','按察使'],
                ['D078P02','正七','经历'],
                ['D078P03','正八','知事'],
                ['D078P04','正九','照磨'],
                ['D078P05','從九','司狱'],
                ['D079P01','正四','粮道'],
                ['D079P02','正四','巡道'],
                ['D079P03','從九','粮庫大使'],
                ['D080P01','','巡查'],
                ['D080P02','','织造'],
                ['D080P03','','关督'],

                ['D096P01','正六','管领'],
                ['D096P02','從六','典饍'],
                ['D096P03','從七','司庫'],
                ['D096P04','從八','司匠'],
                ['D096P05','從八','牛群牧长'],
                ['D096P06','從八','羊群牧长'],
                ['D097P01','正五','監正'],
                ['D097P02','正六','監副'],
                ['D097P03','從六','五官正'],
                ['D097P04','從七','灵台郎'],
                ['D097P05','正八','保章正'],
                ['D097P06','正八','主簿'],
                ['D097P07','從八','掣壶'],
                ['D097P08','從八','監侯'],
                ['D097P09','正九','司書'],
                ['D097P10','從九','司晨'],
                ['D097P11','從九','博士'],
                ['D097P12','未入','正术'],
                ['D097P13','未入','典术'],
                ['D098P01','正一','掌衛事大臣'],
                ['D098P02','正二','銮仪使'],
                ['D098P03','正三','冠軍使'],
                ['D098P04','正四','云麾使'],
                ['D098P05','正五','治仪正'],
                ['D098P06','正六','整仪尉'],
                ['D098P07','正六','主事'],
                ['D098P08','正七','经历'],
                ['D099P01','','正監督'],
                ['D099P02','','副監督'],
                ['D100P01','正二','侍郎'],
                ['D100P02','','坐粮厅'],
                ['D100P03','','各仓監督'],
                ['D101P01','正六','正挥'],
                ['D101P02','正七','副挥'],
                ['D101P03','未入','吏目'],
                ['D102P01','正一','總督'],
                ['D102P02','','巡捕'],
                ['D103P01','正一','漕督'],
                ['D103P02','從五','巡漕御史'],
                ['D104P01','','巡捕'],
                ['D105P01','從一','尚書'],
                ['D105P02','正二','左侍郎'],
                ['D105P03','正二','右侍郎'],
                ['D105P04','正五','郎中'],
                ['D105P05','從五','員外'],
                ['D105P06','正六','主事'],
                ['D106P01','從一','左都御史'],
                ['D106P02','正二','副都御史'],
                ['D106P03','從五','監察御史'],
                ['D106P04','從五','巡城御史'],
                ['D106P05','從五','巡街御史'],
                ['D106P06','正六','都事'],
                ['D106P07','正六','经历'],
                ['D107P01','正四','正卿'],
                ['D107P02','正五','郎中'],
                ['D107P03','從五','員外'],
                ['D107P04','正七','朝鮮通事'],
                ['D107P05','正八','朝鮮通事'],
                ['D107P06','正九','朝鮮通事'],
                ['D107P07','正九','大使'],
                ['D107P08','從九','正教序班'],
                ['D108P01','正二','總管'],
                ['D108P02','正五','郎中'],
                ['D108P03','從五','員外'],
                ['D108P04','從六','主事'],
                ['D108P05','從五','管领'],
                ['D108P06','正六','副管领'],
                ['D108P07','正六','司俎'],
                ['D108P08','正九','司庫'],
                ['D108P09','正九','司匠'],
                ['D109P01','正一','大學士'],
                ['D109P02','從一','协办大學士'],
                ['D109P03','從二','學士'],
                ['D109P04','從四','侍读學士'],
                ['D109P05','正六','侍读'],
                ['D109P06','從七','侍读'],
                ['D109P07','正七','典籍'],
                ['D109P08','正七','中書'],
                ['D110P01','',    '宗令'],
                ['D110P02','',    '宗正'],
                ['D110P03','',    '宗人'],
                ['D110P04','正三','宗丞'],
                ['D110P05','正五','正理事'],
                ['D110P06','從六','副理事'],
                ['D110P07','正六','主事'],
                ['D110P08','正六','经历'],
                ['D111P01','正一','尚書'],
                ['D111P02','正二','左侍郎'],
                ['D111P03','正二','右侍郎'],
                ['D111P04','正五','郎中'],
                ['D111P05','從五','員外'],
                ['D111P06','正六','主事'],
                ['D111P07','',    '即用知縣'],
                ['D111P08','',    '候选知縣'],
                ['D111P09','',    '大挑舉人'],
                ['D112P01','正一','尚書'],
                ['D112P02','正二','左侍郎'],
                ['D112P03','正二','右侍郎'],
                ['D112P04','正五','郎中'],
                ['D112P05','從五','員外'],
                ['D112P06','正六','主事'],
                ['D112P07','正七','司庫'],
                ['D112P08','未入','大使'],
                ['D112P09','',    '宝泉局'],

                ['D117P01','從四','祭酒'],
                ['D117P02','正六','司业'],
                ['D117P03','正七','監丞'],
                ['D117P04','從八','博士'],
                ['D117P05','從八','助教'],
                ['D117P06','正八','學正'],
                ['D117P07','從八','學录'],
                ['D117P08','從八','典籍'],
                ['D117P09','從八','典簿'],
                ['D117P10','','教习'],
                ['D118P01','正四','侍读學'],
                ['D118P02','正五','侍读讲'],
                ['D118P03','從六','修撰'],
                ['D118P04','正七','编修'],
                ['D118P05','從七','检讨'],
                ['D118P06','從七','庶吉士'],
                ['D118P07','正八','五经博士'],
                ['D118P08','從八','典簿'],
                ['D118P09','從九','待诏'],
                ['D118P10','未入','孔目'],
                ['D118P11','','教习庶吉士'],
                ['D118P12','','掌院學士'],
                ['D119P01','正三','正詹'],
                ['D119P02','正四','少詹'],
                ['D119P03','正五','左庶子'],
                ['D119P04','正五','右庶子'],
                ['D119P05','從五','洗马'],
                ['D119P06','正六','左中允'],
                ['D119P07','正六','右中允'],
                ['D119P08','從六','左赞善'],
                ['D119P09','從六','右赞善'],
                ['D119P10','從九','主簿'],
                ['D119P11','從九','正字'],
                ['D120P01','','和碩亲王'],
                ['D120P02','','多羅郡王'],
                ['D120P03','','多羅贝勒'],
                ['D120P04','','固山贝子'],
                ['D120P05','','镇国公'],
                ['D120P06','','辅国公'],
                ['D120P07','不入','镇国公'],
                ['D120P08','不如','辅国公'],
                ['D120P09','','镇国将軍'],
                ['D120P10','','辅国将軍'],
                ['D120P11','','奉国将軍'],
                ['D120P12','','奉恩将軍'],
                ['D121P01','','王爵'],
                ['D121P02','','公爵'],
                ['D121P03','','侯爵'],
                ['D121P04','','伯爵'],
                ['D121P05','','子爵'],
                ['D121P06','','男爵'],
                ['D122P01','','一等轻车都尉'],
                ['D122P02','','二等轻车都尉'],
                ['D122P03','','三等轻车都尉'],
                ['D122P04','','騎都尉'],
                ['D122P05','','云騎尉'],
                ['D122P06','','恩騎尉'],
                ['D123P01','','衍聖公'],
                ['D123P02','','朝鮮王'],
                ['D123P03','','安南王'],
                ['D123P04','','琉球王'],
                ['D123P05','','海澄公'],
                ['D123P06','','近恩侯'],
                ['D124P01','','和碩額驸'],
                ['D124P02','','多羅額驸'],
                ['D124P03','','縣主額驸'],
                ['D124P04','','郡君額驸'],
                ['D124P05','','縣君額驸'],
                ['D124P06','','鄉君額驸'],
                ['D125P01','','歼闯寇'],
                ['D125P02','','定西藏'],
                ['D125P03','','平金川'],
                ['D125P04','','平回部'],
                ['D125P05','','征廓泉'],
                ['D125P06','','征台湾'],

                ['D129P01','正一','光禄大夫'],
                ['D129P02','正二','资政大夫'],
                ['D129P03','正三','通議大夫'],
                ['D129P04','正四','中宪大夫'],
                ['D129P05','正五','奉政大夫'],
                ['D129P06','正六','承德郎'],
                ['D129P07','正七','文德郎'],
                ['D129P08','正八','修職郎'],
                ['D129P09','正九','登仕郎'],
                ['D130P01','','经筵讲官'],
                ['D130P02','','上書房'],
                ['D130P03','','南書房'],
                ['D130P04','','绣書房'],
                ['D130P05','','軍机处'],
                ['D130P06','','起居注'],
                ];

var level = ["正一品","從一品","正二品","從二品","正三品","從三品","正四品","從四品","正五品","從五品","正六品","從六品","正七品","從七品","正八品","從八品","正九品","從九品","未入流"];
//var level = "正一品從一品正二品從二品正三品從三品正四品從四品正五品從五品正六品從六品正七品從七品正八品從八品正九品從九品未入流";
//var level = "正一01一等01從一02正二03二等03從二04正三05三等05從三06正四07四等07從四08正五09從五10正六11從六12正七13從七14正八15從八16正九17從九18未入19";
//var level = "正一品01一等01從一品02正二品03二等03從二品04正三品05三等05從三品06正四品07四等07從四品08正五品09從五品10正六品11從六品12正七品13從七品14正八品5從八品16正九品17從九品18未入流19";

// test
var Department = [["起首",0,0],
                  ["出身",0,0],
                  ["京縣衙門",1,0],
                  ["布政司衙門",1,1],
                  ["外省衙門",1,2],
                  ["按察司衙門",1,3],
                  ["外縣衙門",1,4],
                  ["外府衙門",1,5],
                  ["外州衙門",1,6],
                  ["翰林院衙門",1,7],
                  ["六部衙門",1,8],
                  ["都察院衙門",1,9],
                  ["九卿衙門",1,10],
                  ["京府衙門",1,11],
                  ["内閣學士衙門",9,0]];
var Position = [["起首","1","","不押","案首","童生","白丁","不押"],
                ["出身","1","","白丁","監生","案首","童生","不押"],
                ["出身","2","","童生","秀才","監生","案首","童生"],
                ["出身","3","","案首","禀生","秀才","監生","童生"],
                ["出身","4","","監生","吏目","典史","驿丞","白丁"],
                ["出身","5","","秀才","解元","舉人","贡生","案首"],
                ["出身","6","","禀生","解元","舉人","贡生","案首"],
                ["出身","7","","贡生","舉人","學正","训导","案首"],
                ["出身","8","","舉人","会元","进士","解元","秀才"],
                ["出身","9","","解元","会元","进士","二甲","禀生"],
                ["出身","10","","进士","榜眼","探花","教授","舉人"],
                ["出身","11","","二甲","榜眼","探花","编修","解元"],
                ["出身","12","","探花","府尹","少卿","修撰","编修"],
                ["出身","13","","榜眼","正卿","少卿","寺正","修撰"],
                ["出身","14","","状元","驸马","學正","府尹","少卿"],
                ["出身","15","","会元","状元","榜眼","探花","解元"],
                ["京縣衙門","10","正六品","京縣","知府","員外","知州","知縣"],
                ["京縣衙門","12","正七品","京丞","京縣","州同","知縣","縣丞"],
                ["京縣衙門","14","正八品","京训","京丞","州判","检讨","孔目"],
                ["京縣衙門","18","未入流","京典","序班","吏目","孔目","監生"],
                ["布政司衙門","4","正三品","布政","學士","侍郎","巡抚","府尹"],
                ["布政司衙門","6","正四品","參政","布政","府尹","按察","少卿"],
                ["布政司衙門","8","正五品","參議","參政","知府","員外","知州"],
                ["布政司衙門","11","從六品","理问","知州","主事","通判","经历"],
                ["布政司衙門","14","正八品","大使","京丞","州判","经历","主簿"],
                ["布政司衙門","15","從八品","照磨","京经","大使","经历","典史"],
                ["總督衙門","1","從一品","總督","太保","尚書","都史","巡抚"],
                ["總督衙門","2","正二品","巡抚","總督","侍郎","學士","府尹"],
                ["總督衙門","3","正四品","道台","巡抚","參政","按察","京縣"],
                ["钦差衙門","1","正一品","總河","太保","尚書","都史","巡抚"],
                ["钦差衙門","2","","驸马","總河","巡抚","副都","府尹"],
                ["钦差衙門","3","","主考","皇亲","","","修撰"],
                ["按察司衙門","1","正三品","按察","布政","正卿","府尹","副史"],
                ["按察司衙門","2","從四品","副史","按察","少卿","府丞","京縣"],
                ["按察司衙門","3","從五品","检事","府丞","副史","參議","知縣"],
                ["按察司衙門","4","從九品","司狱","京典","吏目","司务","典史"],
                ["外縣衙門","1","正七品","知縣","知州","京判","州同","经历"],
                ["外縣衙門","2","正八品","縣丞","知縣","京经","學正","司务"],
                ["外縣衙門","3","從八品","训导","教授","经历","京训","吏目"],
                ["外縣衙門","4","從九品","主簿","縣丞","大使","照磨","驿丞"],
                ["外縣衙門","5","未入流","典史","司务","吏目","孔目","監生"],
                ["知府衙門","1","正四品","知府","府尹","少卿","府丞","检事"],
                ["知府衙門","2","正五品","同知","知府","參議","治中","京丞"],
                ["知府衙門","3","正六品","通判","同知","京训","检事","司庫"],
                ["知府衙門","4","正七品","教授","知州","寺正","检讨","學正"],
                ["知府衙門","5","正八品","经历","知縣","司庫","州判","检事"],
                ["知府衙門","6","從八品","巡检","知縣","司务","京判","驿丞"],
                ["知府衙門","7","未入流","驿丞","巡检","司狱","典史","白丁"],
                ["外州衙門","1","從五品","知州","知府","參議","检事","京縣"],
                ["外州衙門","2","從六品","州同","知州","寺正","京判","州判"],
                ["外州衙門","3","從七品","州判","州同","知縣","京丞","训导"],
                ["外州衙門","4","正八品","學正","知縣","检讨","京经","照磨"],
                ["外州衙門","5","從九品","吏目","照磨","司狱","主簿","典史"],
                ["翰林院衙門","1","正二品","學士","尚書","都史","總督","正卿"],
                ["翰林院衙門","2","正五品","侍读","副都","正卿","道台","同知"],
                ["翰林院衙門","3","正六品","修撰","府丞","郎中","知府","编修"],
                ["翰林院衙門","4","正七品","编修","監察","修撰","知府","编修"],
                ["翰林院衙門","5","從七品","检讨","監察","编修","知州","巡检"],
                ["翰林院衙門","6","從九品","序班","州判","司庫","縣丞","司务"],
                ["翰林院衙門","7","未入流","孔目","教授","通判","训导","驿丞"],
                ["六部衙門","1","正一品","尚書","太师","太傅","太保","侍郎"],
                ["六部衙門","2","正二品","侍郎","尚書","都史","都督","副都"],
                ["六部衙門","3","正五品","郎中","道台","知府","副史","知州"],
                ["六部衙門","4","從五品","員外","府丞","參議","侍读","京判"],
                ["六部衙門","5","正六品","主事","知府","治中","检事","寺副"],
                ["六部衙門","6","正七品","司庫","寺正","寺副","理问","縣丞"],
                ["六部衙門","7","從九品","司务","大使","照磨","主簿","孔目"],
                ["都察院衙門","1","正一品","都史","太傅","太保","尚書","侍郎"],
                ["都察院衙門","2","","皇亲","總河","監督","侍郎","府尹"],
                ["都察院衙門","3","正三品","副都","學士","侍郎","巡抚","少卿"],
                ["都察院衙門","4","正五品","監察","主考","侍读","道台","编修"],
                ["九卿衙門","1","正三品","正卿","巡抚","布政","副都","副史"],
                ["九卿衙門","2","正四品","少卿","正卿","參政","府尹","郎中"],
                ["九卿衙門","3","正六品","寺正","府尹","道台","郎中","京判"],
                ["九卿衙門","4","從六品","寺副","員外","京判","同知","理问"],
                ["九卿衙門","5","正七品","评事","同知","主事","京经","巡检"],
                ["京府衙門","1","正三品","府尹","巡抚","布政","正卿","少卿"],
                ["京府衙門","2","正四品","府丞","監察","府尹","少卿","治中"],
                ["京府衙門","3","正五品","治中","少卿","府丞","知府","京縣"],
                ["京府衙門","4","正六品","京判","參議","检事","知州","理问"],
                ["京府衙門","5","從七品","京经","理问","知府","主事","吏目"],
                ["内閣學士衙門","1","三公","太师","荣归","荣归","庆贺","免贺"],
                ["内閣學士衙門","2","三公","太傅","太师","庆贺","庆贺","免贺"],
                ["内閣學士衙門","3","三公","太保","太傅","庆贺","庆贺","免贺"]];

function diceDoFamily(){
  for(i=0; i<6; i++){
    dice[i]=Math.floor(Math.random()*6+0.99);
  }
  diceShow();
  return diceGetFamily();
}

function diceDoRun(){
  for(i=0; i<6; i++){
    dice[i]=Math.floor(Math.random()*6+1);
  }
  //dice[0]=4;dice[1]=3;dice[2]=2;dice[3]=1;dice[4]=5;dice[5]=6;
  diceShow();
  return diceGetRun();
}

var do_step=0;
var game_step="";
var game_steptype="";

function diceDo(){
  var dicedovalue = document.getElementById("dicedo").value;

  if(dicedovalue == "获得身份"){
    document.getElementById("dicedo").value=diceDoFamily();
    do_step=1;
  }else if(dicedovalue == "请投骰"){
    document.getElementById("dicedo").value=diceDoRun();
    do_step=2;
  }else if(dicedovalue == "重投"){
    diceDeck();
    document.getElementById("dicedo").value = "请投骰";
    do_step=0;
  }else{
    if(do_step==1){
      game_step=getPosition(dicedovalue);
      document.getElementById(game_step).className="POSIACT_FM";
      document.getElementById("family").innerHTML = dicedovalue;
      document.getElementById("current").innerHTML = dicedovalue;
      document.getElementById("current_year").innerHTML = yearGet();
      currentYear++;
      window.location.href="#"+game_step;
      diceDeck();
      document.getElementById("dicedo").value = "请投骰";
      do_step=0;
    }
    if(do_step==2){
      document.getElementById("current_year").innerHTML = yearGet();
      currentYear++;
      str = document.getElementById("dicedo").value;
//    diceact = str.substr(0,1);
//    act = getPositionAct(game_step,diceact);
//    cn = document.getElementById(game_step).className;
//    document.getElementById(game_step).className=cn.substr(0,4)+cn.substr(7,3);
//    game_step=act;
//    cn = document.getElementById(game_step).className;
//    document.getElementById(game_step).className=cn.substr(0,4)+"ACT"+cn.substr(4,3);
//    window.location.href="#"+game_step;
      document.getElementById("dicedo").value = str.substr(1,str.length-1);
      if (document.getElementById("dicedo").value == ""){
        diceDeck();
        document.getElementById("dicedo").value = "请投骰";
        do_step=0;
      }
    }
  }
}

function diceShow(){
  for(i=0; i<6; i++){
    if(dice[i]==1||dice[i]==4){
      document.getElementById("dice"+(i+1)+"_back").innerHTML = "<font color=red>" + diceTils[diceType][dice[i]] + "</font>";
    }else{
      document.getElementById("dice"+(i+1)+"_back").innerHTML = diceTils[diceType][dice[i]];
    }
    document.getElementById("dice"+(i+1)).classList.add('diceshow');
  }
}

function diceDeck(){
  for(i=1;i<=6;i++){
    document.getElementById("dice"+i).classList.remove('diceshow');
  }
}

function yearGet(){
  var years = ["十", "一", "二", "三", "四", "五", "六", "七", "八", "九", "十"];
  var age = parseInt(currentYear/4);
  if(age<=10){
    return years[age];
  }
  if(age<20){
    return "十" + years[age-10];
  }
  if(age<100){
    var i = parseInt(age / 10);
    var j = age % 10;
    var s="";
    if( j != 0){
      s = years[i] + "十" + years[j];
    }else{
      s = years[i] + "十";
    }
    return s;
  }
}

function diceGetFamily(){
  dice.sort();
  dice.reverse();
  dicevalue = "";
  diceTotal = 0;
  j=0;
  diceZero = 0;
  diceCount[0][0]=0;

  for(i=0; i<6; i++){
    if(dice[i]==0){
      diceZero++;
    }
    dicevalue = dicevalue + dice[i];
    diceTotal= diceTotal+dice[i];
    if(diceCount[j][1] != dice[i]){
      if(diceCount[j][0]!=0){
        j=j+1;
        diceCount[j+1][0]=0;
      }
      diceCount[j][0]=1;
      diceCount[j][1]=dice[i];
    }else{
      diceCount[j][0]=diceCount[j][0]+1;
    }
  }
  if(diceZero>=1){
    diceZero=Math.floor(Math.random()*2+1);
    if(diceZero==0){
      // document.getElementById("dicevalue").innerHTML = "天文生";
      return "天文生";
    }
    if(diceZero==1){
      // document.getElementById("dicevalue").innerHTML = "醫生";
      return "醫生";
    }
    if(diceZero==2){
      // document.getElementById("dicevalue").innerHTML = "土司";
      return "土司";
    }
  }
  s="";
  diceCount.sort();
  diceCount.reverse();
  for(i=0;i<6;i++){
    if(diceCount[i][0]>1){
      s = s + " " + diceCount[i][0] + diceCount[i][1];
    }
  }
  s = s.replace(/\s+/g,"");
  for(i=0; i<diceFamily.length; i++){
    if(s.indexOf(diceFamily[i][0])==0){
      if(diceFamily[i][2]!=""){
        if(diceTotal == Math.floor(diceFamily[i][2])){
          // document.getElementById("dicevalue").innerHTML = diceFamily[i][1];
          return diceFamily[i][1];
        }
      }else{
        //document.getElementById("dicevalue").innerHTML = diceFamily[i][1];
        return diceFamily[i][1];
      }
    }
  }
  //document.getElementById("dicevalue").innerHTML = "其它";
  return "其它";
}

function diceGetRun(){
  dice.sort();
  dice.reverse();
  dicevalue = "";
  diceTotal = 0;
  j=0;
  diceZero = 0;
  diceCount[0][0]=0;
  diceHas4=0;
  for(i=0; i<6; i++){
    if(dice[i]==4){
      diceHas4=1;
    }
    dicevalue = dicevalue + dice[i];
    diceTotal= diceTotal+dice[i];
    if(diceCount[j][1] != dice[i]){
      if(diceCount[j][0]!=0){
        j=j+1;
        diceCount[j+1][0]=0;
      }
      diceCount[j][0]=1;
      diceCount[j][1]=dice[i];
    }else{
      diceCount[j][0]=diceCount[j][0]+1;
    }
  }
  if(diceZero>=1){
    //document.getElementById("dicevalue").innerHTML = "重投";
    return "重投";
  }
  s="";
  diceCount.sort();
  diceCount.reverse();
  for(i=0;i<6;i++){
    if(diceCount[i][0]>1){
      s = s + " " + diceCount[i][0] + diceCount[i][1];
    }
  }


  //s = s.replace(/\s+/g,"");
  ret = "";
//  document.getElementById("dicevalue").innerHTML = "";
  for(i=0; i<diceRun.length; i++){
    if(s.indexOf(" " + diceRun[i][0])>=0){
      if(diceHas4==1&&diceRun[i][1]=="庄"){
        ;
      }else{
        // document.getElementById("dicevalue").innerHTML += diceRun[i][1];
        ret += diceRun[i][1];
        if(diceRun[i][2]==0){
          return ret;
        }
      }
    }
  }
//  if(document.getElementById("dicevalue").innerHTML==""){
//    document.getElementById("dicevalue").innerHTML = "重投";
//  }
  if(ret==""){
    ret = "重投";
  }
  return ret;
}

function getDepartment(dep){
  var i;
  for(i=0;i<Department.length;i++){
    if(Department[i][0]==dep){
      if(Department[i][1]==1){
        return Department[i][2];
      }else{
        return -1;
      }
    }
  }
  return -1;
}

function getPositionLevel(poslv){
  var i;
  for(i=0;i<level.length;i++){
    if(level[i]==poslv){
      return i;
    }
  }
  return -1;
}

function getPosition(nm){
  for(i=0;i<position.length;i++){
    if(position[i][2]==nm){
      return position[i][0];
    }
  }
  return -1;
}

function getPositionAct(id, diceact){
  for(i=0;i<position.length;i++){
    if(position[i][0]==id){
      j = diceName.indexOf(diceact);
      if(j>=0){
        return position[i][j*2+4];
      }else{
        return -1;
      }
    }
  }
  return -1;
}

function departmentArranged1(){
  s = "";
  s = "<table align=center width=" + Department.length*100 + "px cellpadding=0 cellspacing=0>";

  var c=new Array();
  var i,j;

  for(i=0;i<Department.length;i++){
    c[i]=new Array();
    for(j=0;j<19;j++){
      c[i][j] = "<td></td>";
    }
  }

  for(i=0;i<Position.length;i++){
    document.getElementById("positionArray").innerHTML = Position[i][0]+getPositionLevel(Position[i][2]);
    if(getDepartment(Position[i][0])>=0){
      c[getDepartment(Position[i][0])][getPositionLevel(Position[i][2])]="<td bgcolor=lightgray>"+Position[i][3]+"</td>";
    }
  }

  for(i=0;i<19;i++){
    s+="<tr>";
    for(j=0;j<Department.length;j++){
      s+=c[j][i];
    }
    s+="</tr>";
  }

  s+="</table>";
  document.getElementById("positionArray").innerHTML = s;
}

function departmentArranged(){
  var d=new Array();
  var s="";
  for(i=0;i<department.length;i++){
    d[i]=new Array();
    d[i][0] = "<div id='" + department[i][0] + "' class='DEPT_" + department[i][2] + "'><a id='" + department[i][0] + "' />" + department[i][1];
    d[i][0] += "<div id='" + department[i][0] + "E' class='EXPD' onclick=\"hideDetail('" + department[i][0] + "');\">▼</div><br>";
    d[i][0] += "<div id='" + department[i][0] + "P' style='display:inline-block;'>";
    d[i][1] = "";
    d[i][2] = "</div></div>";
  }
  var j;
  var t;
  for(i=0;i<position.length;i++){
    j = position[i][0].substr(1,3) - 1;
    if(position[i].length>13){
      t="德:"+ position[i][3] + "&#13;才:"+ position[i][5] + "&#13;功:"+ position[i][7] + "&#13;良:"+ position[i][9] + "&#13;由:"+ position[i][11] + "&#13;庄:" + position[i][13];
    }else{
      t="";
    }
    d[j][1] += "<div id='" + position[i][0] + "' class='POSI_" + department[j][2] + "' title='" + t + "'><a id='" + position[i][0] + "' /><div class='LEVL'>" + position[i][1] + "</div>" + position[i][2] + "</div>";
  }
  for(i=0;i<d.length;i++){
    s=d[i][0]+d[i][1]+d[i][2]+s;
  }
  document.getElementById("positionArray").innerHTML = s;

}

    </script>
  <style>

.diceArea{
  perspective:800px;position:fixed;
  left:6px;top:6px;width:176px;height:48px;
  text-align:center;vertical-align:middle;
  background-color:#4B5;
  border-style:solid;border-width:8px;border-radius:5pt;border-color:#4B5;
  box-shadow:4px 4px 4px #000;}
.diceshow .dicef{
  transform:rotateY(180deg);z-index:1}
.diceshow .diceb{
  transform:rotateY(0deg);z-index:2;}
.dice{
  width:24px;height:22px;
  transform-style:preserve-3d;
  display:block;position:fixed}
.dicef,.diceb{
  position:absolute;
  top:0;left:0;width:24px;height:22px;
  background-color:#EEE;
  text-align:center;vertical-align:middle;
  border-left-color:#DDD;border-top-color:#DDD;
  border-right-color:#AAA;border-bottom-color:#999;
  border-width:1px;border-style:solid;
  border-radius:5pt;
  transition:all .2s linear;
  backface-visibility:hidden;}
.dicef{z-index:2;transform: rotateY(0deg);}
.diceb{z-index:1;transform: rotateY(-180deg);}

.DEPT_,.DEPT_CV,.DEPT_MO,.DEPT_MG,.DEPT_MC,.DEPT_ET,.DEPT_FM,.DEPT_RP{
  display:inline-block;
  width:200px;margin:2;padding:2;
  text-align:left;vertical-align:top;
  box-shadow:2px 2px 2px #000;
  border-radius:5px;border-bottom-left-radius:0px;border-bottom-right-radius:0px;
  border-style:solid;border-width:1px;}
.POSI_,.POSI_CV,.POSI_MO,.POSI_MG,.POSI_MC,.POSI_ET,.POSI_FM,.POSI_RP{
  position:relative;
  left:16px;width:180px;margin:1;padding:1;
  text-align:left;vertical-align:top;
  box-shadow:1px 1px 1px #000;
  border-radius:2px;
  border-style:solid;border-width:1px;}
.POSIACT_,.POSIACT_CV,.POSIACT_MO,.POSIACT_MG,.POSIACT_MC,.POSIACT_ET,.POSIACT_FM,.POSIACT_RP{
  position:relative;
  left:16px;width:180px;margin:1;padding:1;
  text-align:left;vertical-align:top;
  box-shadow:1px 1px 1px #000;
  border-radius:2px;
  border-style:solid;border-width:1px;}
.DEPT_   {color:#000;background-color:#EEE;border-color:#EEE}
.POSI_   {color:#000;background-color:#BBB;border-color:#999}
.POSIACT_{color:#000;background-color:#999;border-color:#888}
.DEPT_CV   {color:#FFF;background-color:#B45;border-color:#934}
.POSI_CV   {color:#FFF;background-color:#B24;border-color:#912}
.POSIACT_CV{color:#FFF;background-color:#B6B;border-color:#924}
.DEPT_MO   {color:#FFF;background-color:#4BB;border-color:#399}
.POSI_MO   {color:#FFF;background-color:#2BB;border-color:#199}
.POSIACT_MO{color:#FFF;background-color:#6BB;border-color:#299}
.DEPT_MG   {color:#FFF;background-color:#BB5;border-color:#994}
.POSI_MG   {color:#FFF;background-color:#BB2;border-color:#991}
.POSIACT_MG{color:#FFF;background-color:#BB6;border-color:#942}
.DEPT_MC   {color:#FFF;background-color:#B5B;border-color:#949}
.POSI_MC   {color:#FFF;background-color:#B2B;border-color:#919}
.POSIACT_MC{color:#FFF;background-color:#B6B;border-color:#924}
.DEPT_ET   {color:#FFF;background-color:#4C5;border-color:#495}
.POSI_ET   {color:#FFF;background-color:#2C3;border-color:#293}
.POSIACT_ET{color:#FFF;background-color:#3C4;border-color:#394}
.DEPT_FM   {color:#FFF;background-color:#555;border-color:#444}
.POSI_FM   {color:#FFF;background-color:#444;border-color:#333}
.POSIACT_FM{color:#FFF;background-color:#666;border-color:#222}
.DEPT_RP   {color:#FFF;background-color:#55B;border-color:#449}
.POSI_RP   {color:#FFF;background-color:#22B;border-color:#119}
.POSIACT_RP{color:#FFF;background-color:#66B;border-color:#249}

.ACTN{
  display:inline-block;
  vertical-align:middle;
  font-size:xx-small;
  left:8;
  text-align:center;
  background-color:#333;
  border-color:#444;
  border-radius:2px;
  border-style:solid;
  position:relative;
  margin:1;
  width:16px;
  border-width:1px}
.LEVL{
  display:inline-block;
  vertical-align:middle;
  font-size:xx-small;
  background-color:#333;
  border-color:#444;
  border-radius:2px;
  border-style:solid;
  margin:1;
  border-width:1px}
.EXPD{
  display:inline-block;
  color:#FF6;
  vertical-align:middle;
  font-size:xx-small;
  text-align:center;
  width:16px;}

  </style>
  <body style="margin:0px;background-color:#666" onselectstart="return false;" onload="onBodyLoad();">
    <br/><br/><br/>
    <div id="positionArray"></div>

    <div id="boardinfo" style="position:fixed;left:440px;top:0px;width:400px;height:150px;background-color:#DAC;box-shadow:4px 4px 4px #000;border-radius:5pt;">
      <table width=100% height=80px><tr><td align=center><font size=80px>滿漢陞官圖</font></table>
      <table width=100% height=24px><tr><td align=left width=100>姓名<div id='name' style='display:inline-block;'></div></td>
                                        <td align=left width=100>当前<div id='current' style='display:inline-block;'></div></td>
                                        <td align=left width=100>出身<div id='family' style='display:inline-block;'></div></td>
                                        <td align=left width=100 nowrap><div id='current_year' style='display:inline-block;'>十六</div>岁</td>
                                    <tr><td align=center colspan=4>公筹 <div id='current_gold' style='display:inline-block;'>1000</div> 金</td></table>
    </div>

    <div id="dicepannel" class="diceArea">
      <div id="dice1" class="dice" style="left:0">
       <div id="dice1_front" class="dicef"></div>
       <div id="dice1_back" class="diceb"></div>
      </div>
      <div id="dice2" class="dice" style="left:30">
       <div id="dice2_front" class="dicef"></div>
       <div id="dice2_back" class="diceb"></div>
      </div>
      <div id="dice3" class="dice" style="left:60">
       <div id="dice3_front" class="dicef"></div>
       <div id="dice3_back" class="diceb"></div>
      </div>
      <div id="dice4" class="dice" style="left:90">
       <div id="dice4_front" class="dicef"></div>
       <div id="dice4_back" class="diceb"></div>
      </div>
      <div id="dice5" class="dice" style="left:120">
       <div id="dice5_front" class="dicef"></div>
       <div id="dice5_back" class="diceb"></div>
      </div>
      <div id="dice6" class="dice" style="left:150">
       <div id="dice6_front" class="dicef"></div>
       <div id="dice6_back" class="diceb"></div>
      </div>
      <br/>
      <input type="button" style="position:fixed;top:26px;left:0px;width:176px;height:24" title="点击这里&#13;开始" value="获得身份" id="dicedo" onclick="diceDo();"/>
    </div>
<hr/>
<p align=center>Copyright (C) 2021, ZZX</p>
  </body>
  <script>


function hideDetail(me){
  if(document.getElementById(me+"E").innerHTML=="▼"){
    document.getElementById(me+"E").innerHTML="▶";
    document.getElementById(me+"P").style.display='none';
  }else{
    document.getElementById(me+"E").innerHTML="▼";
    document.getElementById(me+"P").style.display='block';
  }
}

departmentArranged();

var dice_pannel = document.querySelector("#dicepannel");

dice_pannel.addEventListener("mousedown", function (e) {
  var x = e.pageX - dice_pannel.offsetLeft;
  var y = e.pageY - dice_pannel.offsetTop;

  document.addEventListener("mousemove", move);
  function move(e) {
    dice_pannel.style.left = e.pageX - x + 'px';
    dice_pannel.style.top = e.pageY - y + 'px';
    return false;
  }

  document.addEventListener("mouseup", function (e) {
    document.removeEventListener("mousemove", move);
    return false;
  })
})

document.body.oncontextmenu = function (e) {
  dice_pannel.style.left = e.clientX - 10 + 'px';
  dice_pannel.style.top = e.clientY - 10 + 'px';
  return false;
}


var board_info = document.querySelector("#boardinfo");

board_info.addEventListener("mousedown", function (e) {
  var x = e.pageX - board_info.offsetLeft;
  var y = e.pageY - board_info.offsetTop;

  document.addEventListener("mousemove", move);
  function move(e) {
    board_info.style.left = e.pageX - x + 'px';
    board_info.style.top = e.pageY - y + 'px';
    return false;
  }

  document.addEventListener("mouseup", function (e) {
    document.removeEventListener("mousemove", move);
    return false;
  })
})

function onBodyLoad(){
  board_info.style.left = (window.innerWidth-parseInt(board_info.offsetWidth))/2;
  board_info.style.top = (window.innerHeight-parseInt(board_info.offsetHeight))/4;
  dice_pannel.style.left = (window.innerWidth-parseInt(dice_pannel.offsetWidth))/2;
  dice_pannel.style.top = (window.innerHeight-parseInt(dice_pannel.offsetHeight))*3/4;
}

  </script>
</html>