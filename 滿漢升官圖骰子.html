<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Board</title>
  </head>
  <script>

var diceTils = [["0","1","2","3","4","5","6"],
                [" ","壹","贰","叁","肆","伍","陆"],
                [" ","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ"],
                [" ","〡","〢","〣","〤","〥","〦"],
                [" ","⚀","⚁","⚂","⚃","⚄","⚅"],
                [" ","🀙","🀚","🀛","🀜","🀝","🀞"],
                [" ","🂡","🂢","🂣","🂤","🂥","🂦"],
                [" ","庄","由","良","德","功","才"]];
var dice = [1,1,1,1,1,1];
var dicevalue = "";
var diceCount = [[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];
var diceType = 0;


var diceFamilyCount=62;
var diceFamily = [["64",    "衍聖公",    "",  ""],
                  ["66",    "朝鮮王",    "",  ""],
                  ["65",    "安南王",    "",  ""],
                  ["63",    "琉球王",    "",  ""],
                  ["62",    "海澄公",    "",  ""],
                  ["61",    "近恩侯",    "",  ""],
                  ["54",    "和碩額驸",  "",  ""],
                  ["56",    "多羅額驸",  "",  ""],
                  ["55",    "縣主額驸",  "",  ""],
                  ["53",    "郡君額驸",  "",  ""],
                  ["52",    "縣君額驸",  "",  ""],
                  ["51",    "鄉君額驸",  "",  ""],
                  ["442",   "聖裔奉祀生","",  ""],
                  ["412",   "賢裔奉祀生","",  ""],
                  ["422",   "賢裔奉祀生","",  ""],
                  ["432",   "賢裔奉祀生","",  ""],
                  ["452",   "賢裔奉祀生","",  ""],
                  ["462",   "賢裔奉祀生","",  ""],
                  ["44",    "台吉",      "20","蒙"],
                  ["46",    "内侍衛",    "30",""],
                  ["45",    "内侍衛",    "25",""],
                  ["43",    "内侍衛",    "15",""],
                  ["44",    "恩賞",      "",  ""],
                  ["46",    "保舉",      "",  ""],
                  ["45",    "詞科",      "",  ""],
                  ["43",    "軍功",      "",  ""],
                  ["42",    "議敘",      "",  ""],
                  ["41",    "鄉勇",      "",  ""],
                  ["3431",  "黃帶子",    "",  ""],
                  ["343",   "紅帶",      "",  ""],
                  ["313",   "紅帶",      "",  ""],
                  ["323",   "紅帶",      "",  ""],
                  ["333",   "紅帶",      "",  ""],
                  ["353",   "紅帶",      "",  ""],
                  ["34",    "筆貼式",    "",  "滿"],
                  ["36",    "繙譯生",    "",  ""],
                  ["35",    "官學生",    "",  "滿"],
                  ["33",    "樂舞生",    "",  ""],
                  ["32",    "供士",      "",  ""],
                  ["31",    "守兵",      "",  ""],
                  ["232221","旗丁",      "",  ""],
                  ["262524","鴻博",      "",  ""],
                  ["24212", "額外中書",  "",  ""],
                  ["24232", "額外旗員",  "",  ""],
                  ["24222", "額外旗員",  "",  ""],
                  ["23222", "額外旗員",  "",  ""],
                  ["23212", "額外旗員",  "",  ""],
                  ["22212", "額外旗員",  "",  ""],
                  ["2421",  "庫史",      "",  ""],
                  ["262",   "職員",      "",  ""],
                  ["252",   "職員",      "",  ""],
                  ["242",   "職員",      "",  ""],
                  ["232",   "職員",      "",  ""],
                  ["222",   "職員",      "",  ""],
                  ["212",   "職員",      "",  ""],
                  ["24",    "生員",      "",  ""],
                  ["26",    "武生",      "",  ""],
                  ["25",    "監生",      "",  ""],
                  ["23",    "驍騎",      "",  ""],
                  ["22",    "吏員",      "",  ""],
                  ["21",    "童生",      "",  ""],
                  ["",      "蔭生",      "",  ""]];
var diceRunCount = 30;
var diceRun = [["44 21", "四德","0"],
               ["34 31", "三德","0"],
               ["24 41", "二德","0"],
               ["24", "一德","1"],
               ["34", "二德","1"],
               ["44", "三德","1"],
               ["54", "四德一才","1"],
               ["64", "七德","1"],
               ["26", "一才","1"],
               ["36", "一才","1"],
               ["46", "一才","1"],
               ["56", "三德一才","1"],
               ["66", "六德一才","1"],
               ["25", "一功","1"],
               ["35", "一功","1"],
               ["45", "一功","1"],
               ["55", "三德一功","1"],
               ["65", "六德一功","1"],
               ["23", "一良","1"],
               ["33", "一良","1"],
               ["43", "一良","1"],
               ["53", "三德","1"],
               ["63", "六德","1"],
               ["22", "一由","1"],
               ["32", "一由","1"],
               ["42", "一由","1"],
               ["52", "二德一才","1"],
               ["62", "五德一才","1"],
               ["21", "一庄","1"],
               ["31", "一庄","1"],
               ["41", "一庄","1"],
               ["51", "二德一功","1"],
               ["61", "五德一功","1"]];

//                  號    名稱           ACT    SYSTEM
var department = [["1",  "出身",        "",""],
                  ["2",  "降官",        "不同二德","漢文"],
                  ["3",  "起服",        "不同二德","漢文"],
                  ["4",  "致士",        "不同二德","漢文"],
                  ["5",  "处分",        "","漢文"],
                  ["6",  "武职处分",    "","漢文"],
                  ["7",  "",            "以上具入公筹",""],
                  ["8",  "河标",        "不同二德",""],
                  ["9",  "漕标",        "不同二德",""],
                  ["10", "旗院",        "",""],
                  ["10", "提标",        "",""],
                  ["12", "鎮标",        "",""],
                  ["13", "协标",        "",""],
                  ["14", "守营",        "",""],
                  ["15", "粮衛",        "",""],
                  ["16", "聖庙",        "",""],
                  ["17", "林庙",        "",""],
                  ["18", "巡防",        "",""],
                  ["19", "軍政",        "",""],
                  ["20", "土府",        "",""],
                  ["21", "土州",        "",""],
                  ["22", "土縣",        "",""],
                  ["23", "武衛",        "",""],
                  ["24", "台吉府",      "不同二德","蒙"],
                  ["25", "漢侍衛府",    "不同二德","漢武"],
                  ["26", "文殿試",      "","漢文"],
                  ["27", "武殿試",      "","漢武"],
                  ["28", "文會試",      "","漢文"],
                  ["29", "武會試",      "","漢武"],
                  ["30", "文鄉試",      "","漢文"],
                  ["31", "武鄉試",      "","漢武"],
                  ["32", "學院",        "不同二德","漢文"],
                  ["33", "會辦軍务",    "不同二德","蒙"],
                  ["34", "旷典",        "不同二德","蒙"],
                  ["35", "各管",        "不同二德","蒙"],
                  ["36", "軍功",        "不同二德","蒙"],
                  ["37", "河功",        "不同二德","蒙"],
                  ["38", "文京察",      "不同二德","蒙"],
                  ["39", "武京察",      "不同二德","蒙"],
                  ["40", "大計",        "不同二德","蒙"],
                  ["41", "功牌",        "不同二德","蒙"],
                  ["42", "大考",        "",""],
                  ["43", "陵寝",        "不同二德",""],
                  ["44", "太僕寺马厂",  "不同二德",""],
                  ["45", "各城駐防",    "不同二德",""],
                  ["46", "外省駐防",    "不同二德",""],
                  ["47", "京畿巡捕五营","不同二德",""],
                  ["48", "督院",        "不同二德",""],
                  ["49", "抚院",        "",""],
                  ["50", "京府",        "",""],
                  ["51", "外府",        "",""],
                  ["52", "直隷州",      "",""],
                  ["53", "外州",        "",""],
                  ["54", "直隷廰",      "",""],
                  ["55", "京縣",        "",""],
                  ["56", "外縣",        "",""],
                  ["57", "兼銜",        "",""],
                  ["58", "钦差軍务",    "",""],
                  ["59", "至聖裔官",    "",""],
                  ["60", "丹使",        "",""],
                  ["61", "满侍衛府",    "",""],
                  ["62", "满八旗",      "",""],
                  ["63", "蒙八旗",      "",""],
                  ["64", "漢八旗",      "",""],
                  ["65", "前锋",        "不同二德",""],
                  ["66", "护軍",        "不同二德",""],
                  ["67", "步軍",        "不同二德",""],
                  ["68", "圆明园",      "不同二德",""],
                  ["69", "火器营",      "不同二德",""],
                  ["70", "健锐营",      "不同二德",""],
                  ["71", "白塔信炮",    "不同二德",""],
                  ["72", "南苑",        "不同二德",""],
                  ["73", "内府包衣",    "不同二德",""],
                  ["74", "王府",        "不同二德","漢武"],
                  ["75", "河院",        "不同二德",""],
                  ["76", "盐院",        "不同二德",""],
                  ["77", "布政使司",    "不同二德",""],
                  ["78", "按察使司",    "不同二德",""],
                  ["79", "各道",        "不同二德",""],
                  ["80", "各差",        "不同二德",""],
                  ["81", "六科",        "",""],
                  ["82", "神樂署",      "",""],
                  ["83", "武備院",      "",""],
                  ["84", "上駟院",      "",""],
                  ["85", "奉宸院",      "",""],
                  ["86", "通政司",      "",""],
                  ["87", "皇史窚",      "",""],
                  ["88", "中書科",      "",""],
                  ["89", "大理寺",      "",""],
                  ["90", "太常寺",      "",""],
                  ["91", "太僕寺",      "",""],
                  ["92", "光禄寺",      "",""],
                  ["93", "鴻臚寺",      "",""],
                  ["94", "各部院",      "",""],
                  ["95", "太醫院",      "",""],
                  ["96", "王府",        "不同二德","漢文"],
                  ["97", "欽天監",      "不同二德",""],
                  ["98", "鑾儀門",      "不同二德",""],
                  ["99", "崇文門",      "不同二德",""],
                  ["100","仓场",        "不同二德",""],
                  ["101","兵马司",      "不同二德",""],
                  ["102","督院",        "不同二德",""],
                  ["103","漕院",        "不同二德",""],
                  ["104","抚院",        "不同二德",""],
                  ["105","理藩院",      "不同二德",""],
                  ["106","都察院",      "不同二德",""],
                  ["107","会同四驿馆",  "不同二德",""],
                  ["108","内务府",      "不同軍功",""],
                  ["109","内閣",        "不同二德",""],
                  ["110","宗人府",      "不同二德",""],
                  ["111","吏部",        "不同二德",""],
                  ["112","户部",        "不同二德",""],
                  ["113","禮部",        "不同二德",""],
                  ["114","兵部",        "不同二德",""],
                  ["115","刑部",        "不同二德",""],
                  ["116","工部",        "不同二德",""],
                  ["117","國子監",      "不同二德",""],
                  ["118","翰林院",      "不同二德",""],
                  ["119","詹事府",      "不同二德",""],
                  ["120","恩袭",        "不同二德",""],
                  ["121","封典",        "",""],
                  ["122","功臣世爵",    "",""],
                  ["123","出身世爵",    "",""],
                  ["124","公主額驸",    "",""],
                  ["125","经略大臣",    "",""],
                  ["126","宫衛",        "",""],
                  ["127","特恩",        "",""],
                  ["128","殿閣大學士",  "",""],
                  ["129","品级考",      "",""],
                  ["130","内廷",        "",""],
                  ["131","出身对照表",  "",""],
                  ["132","颜色对照表",  "",""],
                  ["133","捐班",        "",""]];

//                號    子  品級   名稱   德       才     功       良     由    庄
var position = [["24", "1","一等","台吉","恩袭·輔國公","120.6","滿八旗·都統","62.1","漢八旗·都統","64.1","外省駐防·都統","46.1","留","24.1","二等台吉","24.2"],
                ["24", "2","二等","台吉","恩袭·鎮國公","120.5","一位","24.1","藩右","","紀錄","","留","24.1","下一","24.3"],
                ["24", "3","三等","台吉","二等台吉","24.2","漢八旗·副都統","","外副都","","入鎮國","","留","24.1","下一","24.4"],
                ["24", "4","四等","台吉","三等台吉","24.3","蒙參","63.3","漢參","","入輔國","","留","24.1","免",""],
                ["43", "1","正三","總管","外副都","","提副","","外總管","","紀錄","","留","","僕總",""]];

var level = ["正一品","從一品","正二品","從二品","正三品","從三品","正四品","從四品","正五品","從五品","正六品","從六品","正七品","從七品","正八品","從八品","正九品","從九品","未入流"];
//var level = "正一品從一品正二品從二品正三品從三品正四品從四品正五品從五品正六品從六品正七品從七品正八品從八品正九品從九品未入流";
//var level = "正一01一等01從一02正二03二等03從二04正三05三等05從三06正四07四等07從四08正五09從五10正六11從六12正七13從七14正八15從八16正九17從九18未入19";
//var level = "正一品01一等01從一品02正二品03二等03從二品04正三品05三等05從三品06正四品07四等07從四品08正五品09從五品10正六品11從六品12正七品13從七品14正八品5從八品16正九品17從九品18未入流19";

// testing...
var Department = [["起首",0,0],
                  ["出身",0,0],
                  ["京縣衙門",1,0],
                  ["布政司衙門",1,1],
                  ["外省衙門",1,2],
                  ["按察司衙門",1,3],
                  ["外縣衙門",1,4],
                  ["外府衙門",1,5],
                  ["外州衙門",1,6],
                  ["翰林院衙門",1,7],
                  ["六部衙門",1,8],
                  ["都察院衙門",1,9],
                  ["九卿衙門",1,10],
                  ["京府衙門",1,11],
                  ["内閣學士衙門",9,0]];
var Position = [["起首","1","","不押","案首","童生","白丁","不押"],
                ["出身","1","","白丁","監生","案首","童生","不押"],
                ["出身","2","","童生","秀才","監生","案首","童生"],
                ["出身","3","","案首","禀生","秀才","監生","童生"],
                ["出身","4","","監生","吏目","典史","驿丞","白丁"],
                ["出身","5","","秀才","解元","舉人","贡生","案首"],
                ["出身","6","","禀生","解元","舉人","贡生","案首"],
                ["出身","7","","贡生","舉人","學正","训导","案首"],
                ["出身","8","","舉人","会元","进士","解元","秀才"],
                ["出身","9","","解元","会元","进士","二甲","禀生"],
                ["出身","10","","进士","榜眼","探花","教授","舉人"],
                ["出身","11","","二甲","榜眼","探花","编修","解元"],
                ["出身","12","","探花","府尹","少卿","修撰","编修"],
                ["出身","13","","榜眼","正卿","少卿","寺正","修撰"],
                ["出身","14","","状元","驸马","學正","府尹","少卿"],
                ["出身","15","","会元","状元","榜眼","探花","解元"],
                ["京縣衙門","10","正六品","京縣","知府","員外","知州","知縣"],
                ["京縣衙門","12","正七品","京丞","京縣","州同","知縣","縣丞"],
                ["京縣衙門","14","正八品","京训","京丞","州判","检讨","孔目"],
                ["京縣衙門","18","未入流","京典","序班","吏目","孔目","監生"],
                ["布政司衙門","4","正三品","布政","學士","侍郎","巡抚","府尹"],
                ["布政司衙門","6","正四品","參政","布政","府尹","按察","少卿"],
                ["布政司衙門","8","正五品","參議","參政","知府","員外","知州"],
                ["布政司衙門","11","從六品","理问","知州","主事","通判","经历"],
                ["布政司衙門","14","正八品","大使","京丞","州判","经历","主簿"],
                ["布政司衙門","15","從八品","照磨","京经","大使","经历","典史"],
                ["總督衙門","1","從一品","總督","太保","尚書","都史","巡抚"],
                ["總督衙門","2","正二品","巡抚","總督","侍郎","學士","府尹"],
                ["總督衙門","3","正四品","道台","巡抚","參政","按察","京縣"],
                ["钦差衙門","1","正一品","總河","太保","尚書","都史","巡抚"],
                ["钦差衙門","2","","驸马","總河","巡抚","副都","府尹"],
                ["钦差衙門","3","","主考","皇亲","","","修撰"],
                ["按察司衙門","1","正三品","按察","布政","正卿","府尹","副史"],
                ["按察司衙門","2","從四品","副史","按察","少卿","府丞","京縣"],
                ["按察司衙門","3","從五品","检事","府丞","副史","參議","知縣"],
                ["按察司衙門","4","從九品","司狱","京典","吏目","司务","典史"],
                ["外縣衙門","1","正七品","知縣","知州","京判","州同","经历"],
                ["外縣衙門","2","正八品","縣丞","知縣","京经","學正","司务"],
                ["外縣衙門","3","從八品","训导","教授","经历","京训","吏目"],
                ["外縣衙門","4","從九品","主簿","縣丞","大使","照磨","驿丞"],
                ["外縣衙門","5","未入流","典史","司务","吏目","孔目","監生"],
                ["知府衙門","1","正四品","知府","府尹","少卿","府丞","检事"],
                ["知府衙門","2","正五品","同知","知府","參議","治中","京丞"],
                ["知府衙門","3","正六品","通判","同知","京训","检事","司库"],
                ["知府衙門","4","正七品","教授","知州","寺正","检讨","學正"],
                ["知府衙門","5","正八品","经历","知縣","司库","州判","检事"],
                ["知府衙門","6","從八品","巡检","知縣","司务","京判","驿丞"],
                ["知府衙門","7","未入流","驿丞","巡检","司狱","典史","白丁"],
                ["外州衙門","1","從五品","知州","知府","參議","检事","京縣"],
                ["外州衙門","2","從六品","州同","知州","寺正","京判","州判"],
                ["外州衙門","3","從七品","州判","州同","知縣","京丞","训导"],
                ["外州衙門","4","正八品","學正","知縣","检讨","京经","照磨"],
                ["外州衙門","5","從九品","吏目","照磨","司狱","主簿","典史"],
                ["翰林院衙門","1","正二品","學士","尚書","都史","總督","正卿"],
                ["翰林院衙門","2","正五品","侍读","副都","正卿","道台","同知"],
                ["翰林院衙門","3","正六品","修撰","府丞","郎中","知府","编修"],
                ["翰林院衙門","4","正七品","编修","監察","修撰","知府","编修"],
                ["翰林院衙門","5","從七品","检讨","監察","编修","知州","巡检"],
                ["翰林院衙門","6","從九品","序班","州判","司库","縣丞","司务"],
                ["翰林院衙門","7","未入流","孔目","教授","通判","训导","驿丞"],
                ["六部衙門","1","正一品","尚書","太师","太傅","太保","侍郎"],
                ["六部衙門","2","正二品","侍郎","尚書","都史","都督","副都"],
                ["六部衙門","3","正五品","郎中","道台","知府","副史","知州"],
                ["六部衙門","4","從五品","員外","府丞","參議","侍读","京判"],
                ["六部衙門","5","正六品","主事","知府","治中","检事","寺副"],
                ["六部衙門","6","正七品","司库","寺正","寺副","理问","縣丞"],
                ["六部衙門","7","從九品","司务","大使","照磨","主簿","孔目"],
                ["都察院衙門","1","正一品","都史","太傅","太保","尚書","侍郎"],
                ["都察院衙門","2","","皇亲","總河","監督","侍郎","府尹"],
                ["都察院衙門","3","正三品","副都","學士","侍郎","巡抚","少卿"],
                ["都察院衙門","4","正五品","監察","主考","侍读","道台","编修"],
                ["九卿衙門","1","正三品","正卿","巡抚","布政","副都","副史"],
                ["九卿衙門","2","正四品","少卿","正卿","參政","府尹","郎中"],
                ["九卿衙門","3","正六品","寺正","府尹","道台","郎中","京判"],
                ["九卿衙門","4","從六品","寺副","員外","京判","同知","理问"],
                ["九卿衙門","5","正七品","评事","同知","主事","京经","巡检"],
                ["京府衙門","1","正三品","府尹","巡抚","布政","正卿","少卿"],
                ["京府衙門","2","正四品","府丞","監察","府尹","少卿","治中"],
                ["京府衙門","3","正五品","治中","少卿","府丞","知府","京縣"],
                ["京府衙門","4","正六品","京判","參議","检事","知州","理问"],
                ["京府衙門","5","從七品","京经","理问","知府","主事","吏目"],
                ["内閣學士衙門","1","三公","太师","荣归","荣归","庆贺","免贺"],
                ["内閣學士衙門","2","三公","太傅","太师","庆贺","庆贺","免贺"],
                ["内閣學士衙門","3","三公","太保","太傅","庆贺","庆贺","免贺"]];

function diceDoFamily() {
  for(i=0; i<6; i++){
    dice[i]=Math.floor(Math.random()*6+0.99);
  }
  diceShow();
  diceGetFamily();
}

function diceDoRun() {
  for(i=0; i<6; i++){
    dice[i]=Math.floor(Math.random()*6+1);
  }
  //dice[0]=4;dice[1]=3;dice[2]=2;dice[3]=1;dice[4]=2;dice[5]=1;
  diceShow();
  diceGetRun();
}

function diceShow() {
  s="";
  for(i=0; i<6; i++){
    if(dice[i]==1||dice[i]==4){
      document.getElementById("dice"+(i+1)).innerHTML = "<font color=red>" + diceTils[diceType][dice[i]] + "</font>";
    }else{
      document.getElementById("dice"+(i+1)).innerHTML = diceTils[diceType][dice[i]];
    }
  }
}

function diceGetFamily(){
  dice.sort();
  dice.reverse();
  dicevalue = "";
  diceTotal = 0;
  j=0;
  diceZero = 0;
  diceCount[0][0]=0;
  for(i=0; i<6; i++){
    if(dice[i]==0){
      diceZero++;
    }
    dicevalue = dicevalue + dice[i];
    diceTotal= diceTotal+dice[i];
    if(diceCount[j][1] != dice[i]){
      if(diceCount[j][0]!=0){
        j=j+1;
        diceCount[j+1][0]=0;
      }
      diceCount[j][0]=1;
      diceCount[j][1]=dice[i];
    }else{
      diceCount[j][0]=diceCount[j][0]+1;
    }
  }
  if(diceZero>=1){
    diceZero=Math.floor(Math.random()*2+1);
    if(diceZero==0)
      document.getElementById("dicevalue").innerHTML = "天文生";
    if(diceZero==1)
      document.getElementById("dicevalue").innerHTML = "醫生";
    if(diceZero==2)
      document.getElementById("dicevalue").innerHTML = "土司";
    return;
  }
  diceCount.sort();
  diceCount.reverse();
  for(i=0;i<6;i++){
    if(diceCount[i][0]>1){
      s = s + " " + diceCount[i][0] + diceCount[i][1];
    }
  }
  s = s.replace(/\s+/g,"");
  for(i=0; i<diceFamilyCount; i++){
    if(s.indexOf(diceFamily[i][0])==0){
      if(diceFamily[i][2]!=""){
        if(diceTotal == Math.floor(diceFamily[i][2])){
          document.getElementById("dicevalue").innerHTML = diceFamily[i][1];
          return;
        }
      }else{
        document.getElementById("dicevalue").innerHTML = diceFamily[i][1];
        return;
      }
    }
  }
  document.getElementById("dicevalue").innerHTML = "其它";
}

function diceGetRun(){
  dice.sort();
  dice.reverse();
  dicevalue = "";
  diceTotal = 0;
  j=0;
  diceZero = 0;
  diceCount[0][0]=0;
  diceHas4=0;
  for(i=0; i<6; i++){
    if(dice[i]==4){
      diceHas4=1;
    }
    dicevalue = dicevalue + dice[i];
    diceTotal= diceTotal+dice[i];
    if(diceCount[j][1] != dice[i]){
      if(diceCount[j][0]!=0){
        j=j+1;
        diceCount[j+1][0]=0;
      }
      diceCount[j][0]=1;
      diceCount[j][1]=dice[i];
    }else{
      diceCount[j][0]=diceCount[j][0]+1;
    }
  }
  if(diceZero>=1){
    document.getElementById("dicevalue").innerHTML = "重投";
    return;
  }
  diceCount.sort();
  diceCount.reverse();
  for(i=0;i<6;i++){
    if(diceCount[i][0]>1){
      s = s + " " + diceCount[i][0] + diceCount[i][1];
    }
  }
  //s = s.replace(/\s+/g,"");
  document.getElementById("dicevalue").innerHTML = "";
  for(i=0; i<diceRunCount; i++){
    if(s.indexOf(" " + diceRun[i][0])>=0){
      if(diceHas4==1&&diceRun[i][1]=="一庄"){
        ;
      }else{
        document.getElementById("dicevalue").innerHTML += diceRun[i][1];
        if(diceRun[i][2]==0){
          return;
        }
      }
    }
  }
  if(document.getElementById("dicevalue").innerHTML==""){
    document.getElementById("dicevalue").innerHTML = "重投";
  }
}

function getDepartment(dep){
  var i;
  for(i=0;i<Department.length;i++){
    if(Department[i][0]==dep){
      if(Department[i][1]==1){
        return Department[i][2];
      }else{
        return -1;
      }
    }
  }
  return -1;
}

function getPositionLevel(poslv){
  var i;
  for(i=0;i<level.length;i++){
    if(level[i]==poslv){
      return i;
    }
  }
  return -1;
}

function departmentArranged(){
  s = "";
  s = "<table align=center width=" + Department.length*100 + "px cellpadding=0 cellspacing=0>";

  var c=new Array();
  var i,j;

  for(i=0;i<Department.length;i++){
    c[i]=new Array();
    for(j=0;j<19;j++){
      c[i][j] = "<td></td>";
    }
  }

  for(i=0;i<Position.length;i++){
document.getElementById("positionArray").innerHTML = Position[i][0]+getPositionLevel(Position[i][2]);
    if(getDepartment(Position[i][0])>=0){
      c[getDepartment(Position[i][0])][getPositionLevel(Position[i][2])]="<td bgcolor=lightgray>"+Position[i][3]+"</td>";
    }
  }

  for(i=0;i<19;i++){
    s+="<tr>";
    for(j=0;j<Department.length;j++){
      s+=c[j][i];
    }
    s+="</tr>";
  }

  s+="</table>";
alert(s);
  document.getElementById("positionArray").innerHTML = s;
}

    </script>
  <style>
.diceArea{
  text-align:center;
  vertical-align:middle;
  box-shadow:4px 4px 4px #000;
  background-color:#4B5;
  border-radius:5pt;
  position:fixed;
  left:6px;
  top:6px;
  width:200px;
  height:50px;
  border-style:solid;
  border-width:8px;
  border-color:#4B5}
.dice{
  display:inline-block;
  width:24px;
  height:20px;
  vertical-align:middle;
  text-align:center;
  border-left-color:#DDD;
  border-top-color:#DDD;
  border-right-color:#AAA;
  border-bottom-color:#999;
  border-width:1px;
  border-style:solid;
  background-color:#EEE;
  border-radius:5pt}
.dicevalue{
  display:inline-block;
  color:#DDD;
  text-align:center;
  background-color:#333;
  border-radius:2pt;
  width:100px;
  height:20px;
  border-left-color:#111;
  border-top-color:#111;
  border-right-color:#555;
  border-bottom-color:#555;
  border-width:2px;
  border-style:solid}
  </style>
  <body style="margin:0px">
    <div style="position:fixed;left:0px;top:0px;width:100%;height:50px;">
      <table width=100% bgcolor=#EEE height=80px><tr><td align=right><font size=80px>BOARD_NAME</font></table>
      <table width=100% bgcolor=#EEE height=24px><tr><td align=left width=100>Name:</td><td align=left width=100>Current:</td><td align=left width=100>Family:</td><td align=left width=100 nowrap>YY年YY月YY日</td></table>
    </div>
    <div class="diceArea">
      <div id="dice1" class="dice"></div>
      <div id="dice2" class="dice"></div>
      <div id="dice3" class="dice"></div>
      <div id="dice4" class="dice"></div>
      <div id="dice5" class="dice"></div>
      <div id="dice6" class="dice"></div>
      <br/>
      <input type="button" value="出身" onclick="diceDoFamily();"/>
      <div id="dicevalue" class="dicevalue">重投</div>
      <input type="button" value="考評" onclick="diceDoRun();"/>
    </div>
    <br><br><br><br><br><br><br>
      <div id="positionArray"></div>

<hr width=50%/>
      <table align=center>
        <tr><td width=10px rowspan=2>出身<td width=2px rowspan=2 bgcolor=black><td width=200px bgcolor=lightyellow>童生
        <tr><td width=200px bgcolor=lightyellow>蔭生
      </table>
<hr/>
<p align=center>Copyright (C) 2021, xxx</p>
  </body>
  <script>
departmentArranged();
  </script>
</html>

